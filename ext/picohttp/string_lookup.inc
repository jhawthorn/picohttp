/* This file is auto-generated by tool/generate_lookup.rb */

static struct string_lookup_t {
  VALUE http_host; /* "HTTP_HOST" */
  VALUE http_accept; /* "HTTP_ACCEPT" */
  VALUE http_cookie; /* "HTTP_COOKIE" */
  VALUE http_referer; /* "HTTP_REFERER" */
  VALUE http_user_agent; /* "HTTP_USER_AGENT" */
  VALUE http_connection; /* "HTTP_CONNECTION" */
  VALUE content_type; /* "CONTENT_TYPE" */
  VALUE http_cache_control; /* "HTTP_CACHE_CONTROL" */
  VALUE http_authorization; /* "HTTP_AUTHORIZATION" */
  VALUE content_length; /* "CONTENT_LENGTH" */
  VALUE http_accept_encoding; /* "HTTP_ACCEPT_ENCODING" */
  VALUE http_accept_language; /* "HTTP_ACCEPT_LANGUAGE" */
  VALUE get; /* "GET" */
  VALUE put; /* "PUT" */
  VALUE post; /* "POST" */
  VALUE head; /* "HEAD" */
  VALUE patch; /* "PATCH" */
  VALUE delete; /* "DELETE" */
  VALUE options; /* "OPTIONS" */
} string_lookup;

static VALUE lookup_header(const char *s, size_t len) {
  switch (len) {
  case 4:
    if ((s[0] | 32) == 'h' && (s[1] | 32) == 'o' && (s[2] | 32) == 's' && (s[3] | 32) == 't') return string_lookup.http_host;
    break;
  case 6:
    if ((s[0] | 32) == 'a' && (s[1] | 32) == 'c' && (s[2] | 32) == 'c' && (s[3] | 32) == 'e' && (s[4] | 32) == 'p' && (s[5] | 32) == 't') return string_lookup.http_accept;
    if ((s[0] | 32) == 'c' && (s[1] | 32) == 'o' && (s[2] | 32) == 'o' && (s[3] | 32) == 'k' && (s[4] | 32) == 'i' && (s[5] | 32) == 'e') return string_lookup.http_cookie;
    break;
  case 7:
    if ((s[0] | 32) == 'r' && (s[1] | 32) == 'e' && (s[2] | 32) == 'f' && (s[3] | 32) == 'e' && (s[4] | 32) == 'r' && (s[5] | 32) == 'e' && (s[6] | 32) == 'r') return string_lookup.http_referer;
    break;
  case 10:
    if ((s[0] | 32) == 'u' && (s[1] | 32) == 's' && (s[2] | 32) == 'e' && (s[3] | 32) == 'r' && (s[4] | 32) == '-' && (s[5] | 32) == 'a' && (s[6] | 32) == 'g' && (s[7] | 32) == 'e' && (s[8] | 32) == 'n' && (s[9] | 32) == 't') return string_lookup.http_user_agent;
    if ((s[0] | 32) == 'c' && (s[1] | 32) == 'o' && (s[2] | 32) == 'n' && (s[3] | 32) == 'n' && (s[4] | 32) == 'e' && (s[5] | 32) == 'c' && (s[6] | 32) == 't' && (s[7] | 32) == 'i' && (s[8] | 32) == 'o' && (s[9] | 32) == 'n') return string_lookup.http_connection;
    break;
  case 12:
    if ((s[0] | 32) == 'c' && (s[1] | 32) == 'o' && (s[2] | 32) == 'n' && (s[3] | 32) == 't' && (s[4] | 32) == 'e' && (s[5] | 32) == 'n' && (s[6] | 32) == 't' && (s[7] | 32) == '-' && (s[8] | 32) == 't' && (s[9] | 32) == 'y' && (s[10] | 32) == 'p' && (s[11] | 32) == 'e') return string_lookup.content_type;
    break;
  case 13:
    if ((s[0] | 32) == 'c' && (s[1] | 32) == 'a' && (s[2] | 32) == 'c' && (s[3] | 32) == 'h' && (s[4] | 32) == 'e' && (s[5] | 32) == '-' && (s[6] | 32) == 'c' && (s[7] | 32) == 'o' && (s[8] | 32) == 'n' && (s[9] | 32) == 't' && (s[10] | 32) == 'r' && (s[11] | 32) == 'o' && (s[12] | 32) == 'l') return string_lookup.http_cache_control;
    if ((s[0] | 32) == 'a' && (s[1] | 32) == 'u' && (s[2] | 32) == 't' && (s[3] | 32) == 'h' && (s[4] | 32) == 'o' && (s[5] | 32) == 'r' && (s[6] | 32) == 'i' && (s[7] | 32) == 'z' && (s[8] | 32) == 'a' && (s[9] | 32) == 't' && (s[10] | 32) == 'i' && (s[11] | 32) == 'o' && (s[12] | 32) == 'n') return string_lookup.http_authorization;
    break;
  case 14:
    if ((s[0] | 32) == 'c' && (s[1] | 32) == 'o' && (s[2] | 32) == 'n' && (s[3] | 32) == 't' && (s[4] | 32) == 'e' && (s[5] | 32) == 'n' && (s[6] | 32) == 't' && (s[7] | 32) == '-' && (s[8] | 32) == 'l' && (s[9] | 32) == 'e' && (s[10] | 32) == 'n' && (s[11] | 32) == 'g' && (s[12] | 32) == 't' && (s[13] | 32) == 'h') return string_lookup.content_length;
    break;
  case 15:
    if ((s[0] | 32) == 'a' && (s[1] | 32) == 'c' && (s[2] | 32) == 'c' && (s[3] | 32) == 'e' && (s[4] | 32) == 'p' && (s[5] | 32) == 't' && (s[6] | 32) == '-' && (s[7] | 32) == 'e' && (s[8] | 32) == 'n' && (s[9] | 32) == 'c' && (s[10] | 32) == 'o' && (s[11] | 32) == 'd' && (s[12] | 32) == 'i' && (s[13] | 32) == 'n' && (s[14] | 32) == 'g') return string_lookup.http_accept_encoding;
    if ((s[0] | 32) == 'a' && (s[1] | 32) == 'c' && (s[2] | 32) == 'c' && (s[3] | 32) == 'e' && (s[4] | 32) == 'p' && (s[5] | 32) == 't' && (s[6] | 32) == '-' && (s[7] | 32) == 'l' && (s[8] | 32) == 'a' && (s[9] | 32) == 'n' && (s[10] | 32) == 'g' && (s[11] | 32) == 'u' && (s[12] | 32) == 'a' && (s[13] | 32) == 'g' && (s[14] | 32) == 'e') return string_lookup.http_accept_language;
    break;
  }
  return Qnil;
}

static VALUE lookup_method(const char *s, size_t len) {
  switch (len) {
  case 3:
    if (s[0] == 'G' && s[1] == 'E' && s[2] == 'T') return string_lookup.get;
    if (s[0] == 'P' && s[1] == 'U' && s[2] == 'T') return string_lookup.put;
    break;
  case 4:
    if (s[0] == 'P' && s[1] == 'O' && s[2] == 'S' && s[3] == 'T') return string_lookup.post;
    if (s[0] == 'H' && s[1] == 'E' && s[2] == 'A' && s[3] == 'D') return string_lookup.head;
    break;
  case 5:
    if (s[0] == 'P' && s[1] == 'A' && s[2] == 'T' && s[3] == 'C' && s[4] == 'H') return string_lookup.patch;
    break;
  case 6:
    if (s[0] == 'D' && s[1] == 'E' && s[2] == 'L' && s[3] == 'E' && s[4] == 'T' && s[5] == 'E') return string_lookup.delete;
    break;
  case 7:
    if (s[0] == 'O' && s[1] == 'P' && s[2] == 'T' && s[3] == 'I' && s[4] == 'O' && s[5] == 'N' && s[6] == 'S') return string_lookup.options;
    break;
  }
  return Qnil;
}

static void string_lookup_mark(void *ptr) {
  struct string_lookup_t *s = ptr;
  rb_gc_mark_movable(s->http_host);
  rb_gc_mark_movable(s->http_accept);
  rb_gc_mark_movable(s->http_cookie);
  rb_gc_mark_movable(s->http_referer);
  rb_gc_mark_movable(s->http_user_agent);
  rb_gc_mark_movable(s->http_connection);
  rb_gc_mark_movable(s->content_type);
  rb_gc_mark_movable(s->http_cache_control);
  rb_gc_mark_movable(s->http_authorization);
  rb_gc_mark_movable(s->content_length);
  rb_gc_mark_movable(s->http_accept_encoding);
  rb_gc_mark_movable(s->http_accept_language);
  rb_gc_mark_movable(s->get);
  rb_gc_mark_movable(s->put);
  rb_gc_mark_movable(s->post);
  rb_gc_mark_movable(s->head);
  rb_gc_mark_movable(s->patch);
  rb_gc_mark_movable(s->delete);
  rb_gc_mark_movable(s->options);
}

static void string_lookup_compact(void *ptr) {
  struct string_lookup_t *s = ptr;
  s->http_host = rb_gc_location(s->http_host);
  s->http_accept = rb_gc_location(s->http_accept);
  s->http_cookie = rb_gc_location(s->http_cookie);
  s->http_referer = rb_gc_location(s->http_referer);
  s->http_user_agent = rb_gc_location(s->http_user_agent);
  s->http_connection = rb_gc_location(s->http_connection);
  s->content_type = rb_gc_location(s->content_type);
  s->http_cache_control = rb_gc_location(s->http_cache_control);
  s->http_authorization = rb_gc_location(s->http_authorization);
  s->content_length = rb_gc_location(s->content_length);
  s->http_accept_encoding = rb_gc_location(s->http_accept_encoding);
  s->http_accept_language = rb_gc_location(s->http_accept_language);
  s->get = rb_gc_location(s->get);
  s->put = rb_gc_location(s->put);
  s->post = rb_gc_location(s->post);
  s->head = rb_gc_location(s->head);
  s->patch = rb_gc_location(s->patch);
  s->delete = rb_gc_location(s->delete);
  s->options = rb_gc_location(s->options);
}

static const rb_data_type_t string_lookup_type = {
  .wrap_struct_name = "picohttp_string_lookup",
  .function = {
    .dmark = string_lookup_mark,
    .dfree = NULL,
    .dsize = NULL,
    .dcompact = string_lookup_compact,
  },
  .flags = RUBY_TYPED_FREE_IMMEDIATELY | RUBY_TYPED_WB_PROTECTED,
};

static void intern_str(VALUE wrapper, VALUE *field, const char *str) {
  RB_OBJ_WRITE(wrapper, field, rb_interned_str_cstr(str));
}

static void init_string_lookup(void) {
  VALUE wrapper = TypedData_Wrap_Struct(0, &string_lookup_type, &string_lookup);
  rb_gc_register_mark_object(wrapper);
  intern_str(wrapper, &string_lookup.http_host, "HTTP_HOST");
  intern_str(wrapper, &string_lookup.http_accept, "HTTP_ACCEPT");
  intern_str(wrapper, &string_lookup.http_cookie, "HTTP_COOKIE");
  intern_str(wrapper, &string_lookup.http_referer, "HTTP_REFERER");
  intern_str(wrapper, &string_lookup.http_user_agent, "HTTP_USER_AGENT");
  intern_str(wrapper, &string_lookup.http_connection, "HTTP_CONNECTION");
  intern_str(wrapper, &string_lookup.content_type, "CONTENT_TYPE");
  intern_str(wrapper, &string_lookup.http_cache_control, "HTTP_CACHE_CONTROL");
  intern_str(wrapper, &string_lookup.http_authorization, "HTTP_AUTHORIZATION");
  intern_str(wrapper, &string_lookup.content_length, "CONTENT_LENGTH");
  intern_str(wrapper, &string_lookup.http_accept_encoding, "HTTP_ACCEPT_ENCODING");
  intern_str(wrapper, &string_lookup.http_accept_language, "HTTP_ACCEPT_LANGUAGE");
  intern_str(wrapper, &string_lookup.get, "GET");
  intern_str(wrapper, &string_lookup.put, "PUT");
  intern_str(wrapper, &string_lookup.post, "POST");
  intern_str(wrapper, &string_lookup.head, "HEAD");
  intern_str(wrapper, &string_lookup.patch, "PATCH");
  intern_str(wrapper, &string_lookup.delete, "DELETE");
  intern_str(wrapper, &string_lookup.options, "OPTIONS");
}

